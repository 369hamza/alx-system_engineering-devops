#!/usr/bin/env bash
# Bash script that displays listening ports, shows listening sockets, and shows the PID and name of the program to which each socket belongs

echo "Active Internet connections (only servers)"
echo "Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name"

# List TCP listening ports with PID/Program name
ss -tlnp | awk 'NR>1 && $1 == "LISTEN" {print "tcp", $2, $3, $4, $5, $6, $7}'

# List UDP listening ports with PID/Program name
ss -ulnp | awk 'NR>1 && $1 == "UNCONN" {print "udp", $2, $3, $4, $5, $6, $7}'

echo "Active UNIX domain sockets (only servers)"
echo "Proto RefCnt Flags       Type       State         I-Node   PID/Program name    Path"

# List UNIX domain sockets with PID/Program name
ss -xlnp | awk 'NR>1 && $1 == "LISTEN" {print "unix", $2, $3, $4, $5, $6, $7}'
